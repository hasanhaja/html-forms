<!DOCTYPE html>
<html>
  <head>
    <title>HTML Form</title>
    <script type="module" src="main.js"></script>
  </head>
  <body>
    <header>
      <h1>HTML Form Demo</h1>
      <p>This is a demo of doing client-side validation using browser APIs.</p>
    </header>
    <section>
      <h2>Essential details</h2>

      <val-setup
        form="#details"
        validate-on="blur"
        val-action="/validate"
      ></val-setup>
      <val-handler
        form="#details"
        default-error-location="#form-error"
      ></val-handler>

      <form method="post" id="details">
        <label>
          <span>First name</span>
          <!-- TODO review syntax for this -->
          <input 
            type="text" 
            id="first-name" 
            name="first-name"
            minlength="2"
            required
            pattern="banana"
            data-val-pattern="Enter 'banana'"
            data-val-required="Enter a first name"
            data-val-minlength="Enter a first name with more than 2 characters"
            aria-describedby="first-name-error"
          >
        </label>
        <!-- TODO review syntax and selector for this -->
        <span id="first-name-error"></span>

        <label>
          <span>Amount</span>
          <!-- TODO review syntax for this -->
          <input
            type="number"
            id="amount"
            name="amount"
            min="2"
            max="6"
            step="2"
            data-val-step="Enter an even number"
            data-val-required="Enter an amount"
            required
            aria-describedby="amount-error"
          >
        </label>
        <span id="amount-error"></span>

        <label>
          <span>Last name</span>
          <input
            type="text" 
            id="last-name" 
            name="last-name"
            minlength="4"
            required
            aria-describedby="last-name-error"
            data-val-server
          >
        </label>
        <span id="last-name-error"></span>

        <label>
          <span>Email</span>
          <input 
            type="email" 
            id="email" 
            name="email"
            required
            data-val-required="Enter an email"
            data-val-server
            aria-describedby="email-error"
          >
        </label>
        <span id="email-error"></span>

        <label>
          <span>Phone number</span>
          <input 
            type="tel" 
            id="phone-number" 
            name="phone-number"
            required
            aria-describedby="phone-number-error"
          >
        </label>
        <span id="phone-number-error"></span>

        <button type="submit">Save</button>

        <span id="form-error"></span>
      </form>
    </section>
    <style>
      form {
        & *, & * > * {
          display: block;
        }

        & * > * {
          margin-block-start: 0.5rem;
        }
        
        & > *:not(span) {
          margin-block-start: 1rem;
        }

        & > span {
          margin-block-start: 0.25rem;
        }
      }

      input {
        &:user-invalid {
          outline: 1px solid red;
          outline-offset: 2px;
          border-radius: 0.25rem;
        }
      }
    </style>
  </body>
</html>
